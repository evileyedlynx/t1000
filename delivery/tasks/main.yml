---
- name: Find files to copy
  find: paths="/home/user/repo/target" recurse=no patterns="*.war"
  register: files_to_copy
- name: fetch files
  fetch: src={{ item.path }} dest=/home/ubuntu/
  with_items: "{{ files_to_copy.files }}"
- name: Copy files
  copy: src="{{ item }}" dest=/var/lib/tomcat8/webapps/
  with_fileglob:
    - "/home/ubuntu/*.war"
    
handlers:
  - restart_tomcat
  service: name=tomcat8
  state: restarted